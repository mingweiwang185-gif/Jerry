# HoloTree 3D ðŸŽ„âœ¨

**HoloTree 3D** æ˜¯ä¸€ä¸ªæžå…·æœªæ¥æ„Ÿçš„äº’åŠ¨å¼ 3D åœ£è¯žæ ‘ä½“éªŒé¡¹ç›®ã€‚å®ƒåˆ©ç”¨ AI æ‰‹åŠ¿è¯†åˆ«æŠ€æœ¯ï¼Œç»“åˆ WebGL ç²’å­ç‰¹æ•ˆï¼Œè®©ç”¨æˆ·é€šè¿‡æ‰‹åŠ¿ä¸Žå…¨æ¯åœ£è¯žæ ‘è¿›è¡Œäº’åŠ¨ï¼Œå”¤é†’è®°å¿†ç…§ç‰‡ï¼Œå¹¶æŽ¢ç´¢è—åœ¨æ ‘ä¸‹çš„è®¸æ„¿ç›²ç›’ã€‚

**ðŸŒ åœ¨çº¿æ¼”ç¤º (Live Demo):** [https://weigesture-magic-tree.xyz](https://weigesture-magic-tree.xyz)

![Project Preview](./preview.png)

---

## ðŸŒŸ æ ¸å¿ƒäº®ç‚¹ (Features)

*   **ðŸ–ï¸ AI æ‰‹åŠ¿æŽ§åˆ¶**: åŸºäºŽ MediaPipe æ·±åº¦é›†æˆï¼Œæ— éœ€é¼ æ ‡é”®ç›˜ï¼ŒæŒ¥æŒ¥æ‰‹å³å¯æŽŒæŽ§å…¨åœºã€‚
*   **ðŸŒŒ æ²‰æµ¸å¼ 3D ç²’å­ç³»ç»Ÿ**: æ•°åƒä¸ªç²’å­ç»„æˆçš„åŠ¨æ€åœ£è¯žæ ‘ï¼Œæ”¯æŒå¤šç§å½¢æ€å˜æ¢ï¼ˆæ ‘å½¢æ€ã€æ˜Ÿç³»å½¢æ€ã€çˆ±å¿ƒå½¢æ€ï¼‰ã€‚
*   **ðŸ“¸ å…¨æ¯å›žå¿†ç›¸å†Œ**: æ”¯æŒç”¨æˆ·ä¸Šä¼ ç…§ç‰‡ï¼Œç…§ç‰‡å°†ä»¥å…¨æ¯å¡ç‰‡çš„å½¢å¼çŽ¯ç»•åœ¨æ ‘å‘¨å›´ï¼Œéšæ‰‹åŠ¿å¾‹åŠ¨ã€‚
*   **ðŸŽ äº’åŠ¨è®¸æ„¿ç›²ç›’**: 
    *   æ ‘ä¸‹çš„ç¤¼ç‰©ç›’ä¸ä»…æ˜¯è£…é¥°ï¼Œç‚¹å‡»å®ƒä»¬ä¼šè¹¦å‡ºæƒŠå–œã€‚
    *   **Make a Wish**: ç”¨æˆ·å¯ä»¥å†™ä¸‹è‡ªå·±çš„æ„¿æœ›ï¼Œè—è¿›ç›²ç›’é‡Œç­‰å¾…è¢«å‘çŽ°ã€‚
*   **ðŸŽµ æ°›å›´éŸ³ä¹æ’­æ”¾å™¨**: å†…ç½®å¤šé¦–åœ£è¯žç»å…¸æ›²ç›®ï¼Œæ”¯æŒä¸Šä¼ è‡ªå®šä¹‰èƒŒæ™¯éŸ³ä¹ã€‚
*   **ðŸš€ æµè§ˆå™¨ä¼˜åŒ–æ¨¡å¼**: ä½¿ç”¨ Electron ä½œä¸ºå¯åŠ¨å™¨ï¼Œè‡ªåŠ¨å”¤èµ·ç³»ç»Ÿé»˜è®¤æµè§ˆå™¨ï¼Œç¡®ä¿ AI æ€§èƒ½å’Œå…¼å®¹æ€§æœ€ä½³ã€‚

---

## ðŸŽ® æ‰‹åŠ¿æ“ä½œæŒ‡å— (Gesture Guide)

ä½“éªŒçš„æ ¸å¿ƒåœ¨äºŽä½ çš„åŒæ‰‹ï¼è¯·ç¡®ä¿æ‘„åƒå¤´èƒ½æ¸…æ™°æ•æ‰åˆ°ä½ çš„æ‰‹éƒ¨åŠ¨ä½œã€‚

| åŠ¨ä½œ | æ‰‹åŠ¿åç§° | è§¦å‘æ•ˆæžœ | è§†è§‰åé¦ˆ |
| :--- | :--- | :--- | :--- |
| **ðŸ–ï¸ å•æ‰‹å¼ å¼€** | **Scatter Magic (é­”æ³•æ•£å°„)** | ç²’å­åƒæ˜Ÿå°˜ä¸€æ ·æ¾æ•£é£˜èˆžï¼Œç…§ç‰‡çŽ¯ç»•é€Ÿåº¦å˜æ…¢ï¼Œé€‚åˆé™é™æ¬£èµã€‚ | ç²’å­è½»å¾®æ‰©æ•£ |
| **ðŸ‘ åŒæ‰‹å¼ å¼€** | **Big Bang (æ˜Ÿç³»çˆ†å‘)** | æ¨¡æ‹Ÿå®‡å®™å¤§çˆ†ç‚¸ï¼Œæ‰€æœ‰ç²’å­å’Œç…§ç‰‡å‘å¤–çŒ›çƒˆæ‰©æ•£ï¼Œæžå…·è§†è§‰å†²å‡»åŠ›ã€‚ | ç²’å­çˆ†å‘å¼æ‰©æ•£ |
| **â˜ï¸ é£ŸæŒ‡æŒ‡å¼•** | **Focus Mode (èšç„¦å›žå¿†)** | åƒç§‘å¹»ç”µå½±ä¸€æ ·ï¼Œé€‰ä¸­çš„ç…§ç‰‡ä¼šé£žåˆ°å±å¹•æ­£ä¸­å¤®æ”¾å¤§æ˜¾ç¤ºã€‚ | ç…§ç‰‡æ”¾å¤§ï¼ŒèƒŒæ™¯å˜æš— |
| **ðŸ«¶ åŒæ‰‹æ¯”å¿ƒ** | **Love Magic (çˆ±å¿ƒé­”æ³•)** | æ‰€æœ‰çš„ç²’å­ä¼šæ±‡èšæˆä¸€ä¸ªå·¨å¤§çš„ 3D çˆ±å¿ƒï¼Œç…§ç‰‡ä¹Ÿä¼šéšä¹‹å˜æˆå¿ƒå½¢æŽ’åˆ—ã€‚ | ç²’å­èšåˆæˆçˆ±å¿ƒå½¢çŠ¶ |
| **âœŠ æ¡æ‹³/è‡ªç„¶** | **Tree Mode (åœ£è¯žæ ‘)** | ç²’å­å›žå½’ç»å…¸çš„åœ†é”¥ä½“åœ£è¯žæ ‘å½¢æ€ï¼Œé¡¶éƒ¨çš„æ˜Ÿæ˜Ÿé—ªè€€ã€‚ | ç»å…¸çš„æ—‹è½¬åœ£è¯žæ ‘ |

> **æç¤º**: å¦‚æžœçŽ¯å¢ƒå…‰çº¿è¾ƒæš—ï¼Œæ‰‹åŠ¿è¯†åˆ«å¯èƒ½ä¼šå—å½±å“ã€‚

---

## ðŸš€ å¿«é€Ÿå¼€å§‹ (Getting Started)

### çŽ¯å¢ƒè¦æ±‚
*   Node.js (v16 æˆ–æ›´é«˜ç‰ˆæœ¬)
*   npm æˆ– yarn

### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/your-username/holotree-3d.git
cd holotree-3d
```

### 2. å®‰è£…ä¾èµ–
```bash
npm install
# æˆ–è€…
yarn install
```

### 3. å¼€å‘æ¨¡å¼è¿è¡Œ
```bash
# å¯åŠ¨ Web æµè§ˆå™¨æ¨¡å¼
npm run dev

# å¯åŠ¨ æ¡Œé¢åº”ç”¨å¼€å‘æ¨¡å¼
npm run electron:dev
```

---

## ðŸ“¦ æ‰“åŒ…ä¸º EXE (Build Executable)

æƒ³è¦ç”Ÿæˆ Windows å¯æ‰§è¡Œæ–‡ä»¶ (.exe) åˆ†äº«ç»™æœ‹å‹ï¼Ÿ

1.  **è¿è¡Œæž„å»ºå‘½ä»¤**:
    ```bash
    npm run electron:build
    ```

2.  **æŸ¥æ‰¾æ–‡ä»¶**:
    æ‰“åŒ…å®ŒæˆåŽï¼Œå¯æ‰§è¡Œæ–‡ä»¶å°†ç”Ÿæˆåœ¨ `release/` ç›®å½•ä¸‹ã€‚

> **æ³¨æ„**: è¯¥ç¨‹åºçŽ°åœ¨æ˜¯ä¸€ä¸ªâ€œå¯åŠ¨å™¨ (Launcher)â€ï¼Œè¿è¡Œ EXE åŽä¼šæ‰“å¼€ä¸€ä¸ªå°çª—å£å¹¶è‡ªåŠ¨è·³è½¬åˆ°ä½ çš„æµè§ˆå™¨ä¸­è¿è¡Œï¼Œè¿™æ˜¯ä¸ºäº†è§£å†³æ‰‹åŠ¿è¯†åˆ«åº“åœ¨ Electron å†…éƒ¨çš„å…¼å®¹æ€§é—®é¢˜ã€‚

---

## ðŸ› ï¸ æŠ€æœ¯æ ˆ (Tech Stack)

*   **æ ¸å¿ƒæ¡†æž¶**: [React 18](https://react.dev/) + [Vite](https://vitejs.dev/) + [TypeScript](https://www.typescriptlang.org/)
*   **æ¡Œé¢å°è£…**: [Electron](https://www.electronjs.org/)
*   **3D æ¸²æŸ“**: [Three.js](https://threejs.org/) + [React Three Fiber](https://docs.pmnd.rs/react-three-fiber)
*   **AI è§†è§‰**: [MediaPipe Hands](https://developers.google.com/mediapipe) (ç”¨äºŽå®žæ—¶æ‰‹éƒ¨è¿½è¸ª)
*   **UI æ ·å¼**: [Tailwind CSS](https://tailwindcss.com/)
*   **åŽæœŸå¤„ç†**: @react-three/postprocessing (Bloom, Vignette)

---

## ðŸ†˜ Electron Main Process Code (Launcher)

å¦‚æžœä½ éœ€è¦æ‰‹åŠ¨ä¿®å¤æˆ–æŸ¥çœ‹ `electron/main.cjs` çš„ä»£ç ï¼Œè¯·å‚è€ƒä»¥ä¸‹å†…å®¹ã€‚è¿™æ®µä»£ç åˆ›å»ºäº†ä¸€ä¸ªæœ¬åœ°é™æ€æ–‡ä»¶æœåŠ¡å™¨ï¼Œå¹¶å”¤èµ·é»˜è®¤æµè§ˆå™¨ã€‚

**File: `electron/main.cjs`**

```javascript
const { app, BrowserWindow, shell, ipcMain } = require('electron');
const http = require('http');
const fs = require('fs');
const path = require('path');

const PORT = 54321;
// Determine if we are in dev mode based on npm script or env
const isDev = process.env.npm_lifecycle_event === 'electron:dev' || !app.isPackaged;

// FIXED: Path to the built files
// In both Dev (unpacked) and Prod (packaged in asar), the relative structure 
// between electron/main.cjs and dist/ folder is preserved by electron-builder configuration.
// So we simply go up one level from this file.
const DIST_DIR = path.join(__dirname, '../dist');

let server;

const mimeTypes = {
  '.html': 'text/html',
  '.js': 'text/javascript',
  '.css': 'text/css',
  '.json': 'application/json',
  '.png': 'image/png',
  '.jpg': 'image/jpg',
  '.gif': 'image/gif',
  '.svg': 'image/svg+xml',
  '.wav': 'audio/wav',
  '.mp3': 'audio/mpeg',
  '.mp4': 'video/mp4',
  '.woff': 'application/font-woff',
  '.ttf': 'application/font-ttf',
  '.eot': 'application/vnd.ms-fontobject',
  '.otf': 'application/font-otf',
  '.wasm': 'application/wasm'
};

function startServer() {
  server = http.createServer((request, response) => {
    // Basic security: prevent directory traversal
    const safePath = path.normalize(request.url).replace(/^(\.\.[\/\\])+/, '');
    let filePath = path.join(DIST_DIR, safePath === '/' ? 'index.html' : safePath);
    
    // Remove query strings
    filePath = filePath.split('?')[0];

    const extname = String(path.extname(filePath)).toLowerCase();
    const contentType = mimeTypes[extname] || 'application/octet-stream';

    fs.readFile(filePath, (error, content) => {
      if (error) {
        if(error.code == 'ENOENT'){
          // SPA Fallback: If file not found, serve index.html (for React Router etc)
          const fallbackPath = path.join(DIST_DIR, 'index.html');
          fs.readFile(fallbackPath, (err, indexContent) => {
             if (err) {
                 console.error(`Failed to load fallback index.html from: ${fallbackPath}`);
                 response.writeHead(500);
                 response.end(`Error loading index.html from "${DIST_DIR}". Did you run "npm run build"?`);
             } else {
                 response.writeHead(200, { 'Content-Type': 'text/html' });
                 response.end(indexContent, 'utf-8');
             }
          });
        } else {
          response.writeHead(500);
          response.end('Server Error: ' + error.code);
        }
      } else {
        response.writeHead(200, { 'Content-Type': contentType });
        response.end(content, 'utf-8');
      }
    });
  });

  server.listen(PORT, () => {
    console.log(`Server running at http://localhost:${PORT}/`);
    console.log(`Serving files from: ${DIST_DIR}`);
    shell.openExternal(`http://localhost:${PORT}`);
  });
}

function createWindow() {
  // Create a small "Launcher" window to keep the process alive
  const win = new BrowserWindow({
    width: 400,
    height: 300,
    title: "HoloTree Launcher",
    autoHideMenuBar: true,
    backgroundColor: '#050510',
    // icon: path.join(__dirname, '../public/icon.png'), // If you have an icon
    webPreferences: {
      nodeIntegration: true,
      contextIsolation: false
    }
  });

  const statusText = isDev ? 'Development Mode (Vite)' : 'Production Mode (Static)';
  const targetUrl = isDev ? 'http://localhost:5173' : `http://localhost:${PORT}`;

  // Simple HTML status page for the launcher window
  const statusHtml = `
    <!DOCTYPE html>
    <html>
    <head>
      <meta charset="UTF-8">
      <title>HoloTree Launcher</title>
      <style>
        body { background:#050510; color:#ffd966; display:flex; flex-direction:column; align-items:center; justify-content:center; height:100vh; font-family:sans-serif; text-align:center; margin:0; user-select:none; }
        h3 { margin: 0 0 10px 0; font-family: serif; font-style: italic; font-size: 24px; }
        p { opacity:0.7; font-size: 14px; margin: 5px 0; color: #fff; }
        .url { font-family:monospace; color:#666; font-size: 12px; margin-bottom: 20px; }
        .btn { margin-top:10px; padding:8px 16px; background:rgba(255,217,102,0.1); border:1px solid #ffd966; color:#ffd966; cursor:pointer; border-radius:4px; font-size:12px; text-transform:uppercase; letter-spacing:1px; transition:0.2s; min-width: 120px; }
        .btn:hover { background:rgba(255,217,102,0.3); }
        .btn.danger { border-color:#ff4444; color:#ff4444; background:rgba(255,68,68,0.1); }
        .btn.danger:hover { background:rgba(255,68,68,0.3); }
        .pulse { width: 12px; height: 12px; background: #00ff00; border-radius: 50%; box-shadow: 0 0 15px #00ff00; margin-bottom: 20px; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { opacity: 1; transform: scale(1); } 50% { opacity: 0.5; transform: scale(0.8); } 100% { opacity: 1; transform: scale(1); } }
      </style>
    </head>
    <body>
      <div class="pulse"></div>
      <h3>HoloTree Running</h3>
      <p>${statusText}</p>
      <p>App opened in your default browser.</p>
      <p class="url">${targetUrl}</p>
      <button class="btn" onclick="require('electron').ipcRenderer.send('reopen')">Re-open Browser</button>
      <button class="btn danger" onclick="window.close()">Exit App</button>
    </body>
    </html>
  `;
  
  win.loadURL(`data:text/html;charset=utf-8,${encodeURIComponent(statusHtml)}`);
}

app.whenReady().then(() => {
  if (isDev) {
    // In dev mode, we assume 'npm run electron:dev' is used, which starts Vite separately.
    // We just open the URL.
    createWindow();
    shell.openExternal('http://localhost:5173');
  } else {
    // In production, we start our own static server.
    startServer();
    createWindow();
  }
});

// Handle re-open request from button
ipcMain.on('reopen', () => {
  if (isDev) {
    shell.openExternal('http://localhost:5173');
  } else {
    shell.openExternal(`http://localhost:${PORT}`);
  }
});

app.on('window-all-closed', () => {
  if (server) server.close();
  app.quit();
});